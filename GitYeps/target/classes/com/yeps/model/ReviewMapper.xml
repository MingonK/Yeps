<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
		PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="com.yeps.model">

	<select id="listReview" resultType="ReviewDTO">
		select * from yeps_review order by rvnum desc
	</select>
	
	<select id="getReview" resultType="ReviewDTO" parameterType="int">
  		select * from yeps_review where rvnum = #{rvnum}
  	</select>
 	
	<insert id="insertReview" parameterType="ReviewDTO">
  		insert into yeps_review values (yeps_review_seq.nextval, #{rnum}, #{mnum}, #{content}, sysdate, #{gradepoint}, #{filenum}, #{ip}, #{recentreview}, #{useful}, #{funny}, #{cool})
  	</insert>
  	
  	<delete id="deleteReview" parameterType="int">
  		delete from yeps_review where rvnum = #{rvnum}
  	</delete>
  	
  	<update id="updateReview" parameterType="ReviewDTO">
  		update yeps_review set content=#{content}, gradepoint=#{gradepoint} where rvnum=#{rvnum}
  	</update>		

  	<select id="new_BestGradePoint" resultType="int">
  		select mnum from yeps_review where rvnum=(select max(rvnum) from yeps_review where gradepoint=(select max(gradepoint) from yeps_review))
  	</select>	
  	
  	<select id="getSelectedRestaurant_Rv" resultType="ReviewDTO" parameterType="int">
  		select *from yeps_review where rnum = #{rnum}
  	</select>
  	
  	<select id="getSelectedRestaurant_Rv_M" resultType="int" parameterType="int">
  		select mnum from yeps_review where rnum = #{rnum}
  	</select>
  	
  	
  	<!--  
  	<select id="mylist_info1" resultType="MemberDTO" parameterType="int" >
  		select *from yeps_member where mnum = #{NBPmnum}
  	</select>
  	-->
  	
  	<select id="review_mylist_info" resultType="ReviewDTO" parameterType="int">
  		select *from yeps_review where rvnum = #{NBPmnum}
  	</select>
  	
  	<!--  
  	<select id="review_mylist_info3" resultType="FileDTO" parameterType="int">
  		select *from yeps_file where filenum = #{NBPmnum}
  	</select>
  	-->
  	
  	<update id="review_mylist_updatedata" parameterType="int">
  		update yeps_review set recentreview='y' where mnum=#{NBPmnum}
  	</update>
  	
  	<select id="GetRestaurantName_Rv" parameterType="int" resultType="int">
  		select rnum from yeps_review where mnum = #{NBPmnum}
  	</select>
  	
  	<select id="recentReviewInfo" resultType="ReviewDTO">
  		select rvnum, gradepoint, content from yeps_review order by rvnum desc 
  	</select>
  	
  	<select id="numList" resultType="ReviewDTO" parameterType="int">
  		select rnum, mnum from yeps_review where rnum= #{reviewIntList}
  	</select>
  	
  	<select id="previous_reviews_Num" resultType="ReviewDTO">
  		select rnum, mnum from yeps_review where recentreview='y'
  	</select>
  	
  	<select id="previous_Rv" resultType="ReviewDTO">
  		select *from yeps_review where recentreview= 'y'
  	</select>
  	
  	<select id="review_keyword" resultType="ReviewDTO" parameterType="String">
  		select *from yeps_review where content like '%'||#{SearchKeyword}||'%'
  	</select>
  	<!--  
  	<update id="review_EstimateCount_update" parameterType="int">
     	 update yeps_review set useful=#{}, funny=#{}, cool=#{} where rvnum=#{} 
	</update>
  	-->
  	
  	
  	
  	
  	
  	
  	
  	<!-- 레스토랑매퍼에 있던 -->
  	<select id="listRestaurantReview" parameterType="ReviewDTO" resultType="ReviewDTO"> 
  		select * from (select rownum rn, A.* from (select * from yeps_review order by rnum desc)A) where rn between #{start} and #{end} 
  	</select>
</mapper>		
